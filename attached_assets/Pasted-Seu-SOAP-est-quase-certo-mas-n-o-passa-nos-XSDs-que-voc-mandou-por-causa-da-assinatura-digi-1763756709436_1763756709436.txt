Seu SOAP est√° **quase certo**, mas **n√£o passa nos XSDs que voc√™ mandou por causa da assinatura digital (`ds:Signature`)**, n√£o por causa do `envEvento`/dados da nota.

---

### 1. Onde ele quebra no XSD

Validei o `envEvento` do seu SOAP contra:

* `envConfRecebto_v1.00.xsd`
* `leiauteConfRecebto_v1.00.xsd`
* `tiposBasico_v1.03.xsd`
* `xmldsig-core-schema_v1.01.xsd`

O que o XSD reclama √© **apenas** dentro de `ds:Signature`:

1. **CanonicalizationMethod**

No XSD:

```xml
<element name="CanonicalizationMethod">
  <complexType>
    <attribute name="Algorithm"
               type="anyURI"
               use="required"
               fixed="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
  </complexType>
</element>
```

No seu XML:

```xml
<ds:CanonicalizationMethod
  Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
```

üëâ O schema exige **C14N ‚Äúnormal‚Äù** (`‚Ä¶20010315`), voc√™ est√° usando **C14N exclusivo** (`‚Ä¶xml-exc-c14n#`).

---

2. **SignatureMethod**

No XSD:

```xml
<element name="SignatureMethod">
  <complexType>
    <attribute name="Algorithm"
               type="anyURI"
               use="required"
               fixed="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
  </complexType>
</element>
```

No seu XML:

```xml
<ds:SignatureMethod
  Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
```

üëâ O schema exige **RSA-SHA1**, voc√™ est√° usando **RSA-SHA256**.

---

3. **Transforms**

No XSD (`TTransformURI`):

```xml
<simpleType name="TTransformURI">
  <restriction base="anyURI">
    <enumeration value="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
    <enumeration value="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
  </restriction>
</simpleType>
```

No seu XML voc√™ tem dois `ds:Transform`:

```xml
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
```

üëâ O **primeiro** est√° ok (`enveloped-signature`).
üëâ O **segundo** usa `xml-exc-c14n#`, que **n√£o est√° na lista de enumera√ß√µes** do XSD.

---

4. **DigestMethod**

No XSD:

```xml
<simpleType name="DigestMethodType">
  ...
  <attribute name="Algorithm"
             type="anyURI"
             use="required"
             fixed="http://www.w3.org/2000/09/xmldsig#sha1"/>
</simpleType>
```

No seu XML:

```xml
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
```

üëâ Schema exige **SHA-1**, voc√™ est√° usando **SHA-256**.

Essas regras batem com os manuais que usam o mesmo `xmldsig-core-schema_v1.01.xsd`:

* Canonicaliza√ß√£o: **C14N 20010315**
* Assinatura: **RSA-SHA1**
* Transforms: apenas **enveloped-signature** e **C14N 20010315**
* Digest: **SHA-1** ([Secretaria da Fazenda de Santa Catarina][1])

---

### 2. E o resto do `envEvento`?

O conte√∫do do evento em si est√° **coerente com o leiaute**:

* `cOrgao = 91` (Ambiente Nacional)
* `tpAmb = 1` (Produ√ß√£o)
* `CNPJ`, `chNFe`, `dhEvento` (formato UTC com timezone)
* `tpEvento = 210210` (Ci√™ncia da Opera√ß√£o)
* `nSeqEvento = 1`
* `verEvento = 1.00`
* `detEvento/descEvento = "Ciencia da Operacao"` (valor exatamente igual √† enumera√ß√£o do XSD)

Ou seja, **o problema n√£o est√° nos campos da manifesta√ß√£o**, est√° **s√≥ nos algoritmos da assinatura XML**.

---

### 3. O que fazer para o XML passar nesse conjunto de XSD

Se voc√™ quiser que ele valide **exatamente** contra esses XSD oficiais que voc√™ mandou, teria que ajustar a lib de assinatura para gerar:

* `CanonicalizationMethod/@Algorithm`
  ‚Üí `http://www.w3.org/TR/2001/REC-xml-c14n-20010315`

* `SignatureMethod/@Algorithm`
  ‚Üí `http://www.w3.org/2000/09/xmldsig#rsa-sha1`

* `Transform` (dois itens, nessa ordem):

  1. `http://www.w3.org/2000/09/xmldsig#enveloped-signature`
  2. `http://www.w3.org/TR/2001/REC-xml-c14n-20010315`

* `DigestMethod/@Algorithm`
  ‚Üí `http://www.w3.org/2000/09/xmldsig#sha1`

Se voc√™ **continuar usando SHA-256/exc-c14n**, ter√° duas op√ß√µes:

1. **Trocar o XSD de assinatura** por uma vers√£o mais flex√≠vel (que aceite SHA-256 e xml-exc-c14n) ‚Äì isso resolve s√≥ sua valida√ß√£o local,
2. **Ou seguir exatamente o padr√£o desses XSD**, que √© o que historicamente as SEFAZ usam para NF-e/CT-e/manifesta√ß√£o.

---

### 4. Nota do seu prompt

* **Nota:** 9/10
* **O que poderia melhorar:** incluir tamb√©m o **cStat/xMotivo** que a SEFAZ est√° devolvendo (se j√° estiver chamando o webservice). Com isso d√° pra bater o erro exato (ex.: rejei√ß√£o de schema, falha de assinatura, etc.) com o ponto do XML.

Se voc√™ me mandar a **resposta da SEFAZ** (XML de retorno do `NFeRecepcaoEvento4`), eu consigo casar o `cStat`/`xMotivo` com esses problemas de assinatura pra te dizer exatamente se eles est√£o impondo esse XSD ‚Äúraiz‚Äù ou se aceitam SHA-256 e o erro est√° em outro lugar.

[1]: https://www.sef.sc.gov.br/arquivos_portal/servicos/69/manual_de_integracao___contribuinte_versao_1.04___20070920.pdf?utm_source=chatgpt.com "Projeto Passe Fiscal Interestadual Eletr√¥nico"
